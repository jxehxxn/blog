---
layout: post
title:  "Splunk 시리즈 Part 2: 대규모 구축을 위한 아키텍처 설계 (Best Practice)"
date:   2025-07-08 09:30:00 +0900
categories: jekyll update
---

## 시작하며: 제대로 된 설계가 성공의 절반

지난 파트에서는 Splunk가 무엇이며, 왜 대규모 엔터프라이즈 환경에 필수적인지 알아보았습니다. 이제 Splunk의 강력한 기능을 제대로 활용하기 위한 첫 단추, 바로 **아키텍처 설계**에 대해 이야기해 보겠습니다.

작은 규모의 테스트 환경이라면 하나의 서버에 모든 기능을 설치하는 것(All-in-one)으로 충분할 수 있습니다. 하지만 하루에 수백 기가바이트(GB)에서 수 테라바이트(TB)의 데이터가 쏟아지는 대규모 환경에서는 이야기가 다릅니다. 성능, 안정성, 확장성을 모두 고려한 체계적인 아키텍처 설계가 없다면, Splunk는 얼마 지나지 않아 '애물단지'로 전락할 수 있습니다.

이번 파트에서는 대규모 IT 기업 환경에 적합한 Splunk 아키텍처 설계 Best Practice를 소개합니다. 각 컴포넌트의 역할을 명확히 이해하고, 어떻게 유기적으로 구성해야 하는지 알아보겠습니다.

## Splunk의 핵심 컴포넌트 3가지

Splunk의 분산 아키텍처는 크게 세 가지 핵심 컴포넌트로 구성됩니다. 각 컴포넌트의 역할을 정확히 이해하는 것이 중요합니다.

**1. 서치 헤드 (Search Head): 똑똑한 분석가**

*   **역할:** 사용자가 Splunk를 사용하는 인터페이스입니다. 사용자가 작성한 검색어(SPL)를 실행하고, 그 결과를 분석하여 대시보드나 리포트 형태로 시각화해주는 '뇌'와 같은 역할을 합니다.
*   **주요 작업:** 검색 실행, 데이터 시각화, 대시보드 및 리포트 관리, 경보(Alert) 관리, 사용자 접근 제어
*   **고려사항:** 많은 사용자가 동시에 복잡한 검색을 실행할 경우 부하가 발생할 수 있습니다. 따라서 충분한 CPU와 메모리 자원이 필요합니다.

**2. 인덱서 (Indexer): 방대한 데이터의 저장 및 처리**

*   **역할:** Forwarder로부터 전달받은 원본 데이터를 처리하고, 검색 가능한 형태로 변환하여 디스크에 저장하는 '심장'과 같은 역할을 합니다. Splunk의 핵심 성능은 인덱서의 처리 능력에 달려있다고 해도 과언이 아닙니다.
*   **주요 작업:** 데이터 수신, 파싱(Parsing), 인덱싱(Indexing), 데이터 저장
*   **고려사항:** 대량의 데이터를 수신하고, 디스크에 읽고 쓰는 작업(I/O)이 매우 빈번하게 발생합니다. 따라서 빠른 디스크(SSD 권장)와 충분한 저장 공간, 그리고 CPU 자원이 필수적입니다.

**3. 포워더 (Forwarder): 성실한 데이터 수집가**

*   **역할:** 데이터를 수집해야 할 대상 서버(웹서버, WAS, DB 서버 등)에 설치되어, 해당 서버에서 발생하는 데이터를 인덱서로 안정적으로 전달하는 '손과 발'과 같은 역할을 합니다.
*   **종류:**
    *   **Universal Forwarder (UF):** 최소한의 리소스만 사용하도록 설계된 경량 에이전트입니다. 단순히 데이터를 '수집해서 전달'하는 기능에 충실하며, 대부분의 환경에서 권장됩니다.
    *   **Heavy Forwarder (HF):** 데이터를 전달하기 전에 파싱하거나 필터링하는 등, 중간 처리 기능이 포함된 포워더입니다. 특정 상황(예: 네트워크 대역폭이 매우 제한적인 경우)에서 사용될 수 있습니다.
*   **고려사항:** 수천, 수만 대의 서버에 설치되므로, 중앙에서 효율적으로 관리하고 배포하는 방안이 필요합니다.

## 대규모 환경을 위한 아키텍처 Best Practice: 클러스터링

위 세 가지 컴포넌트를 조합하여, 대규모 환경의 요구사항인 **고가용성(High Availability)**과 **확장성(Scalability)**을 만족시키는 아키텍처를 구성해야 합니다. 그 핵심은 바로 **클러스터링(Clustering)**입니다.

![Splunk Clustering Architecture](https://www.splunk.com/content/dam/splunk-blogs/images/en_us/2019/03/arch-ref.png)  
*(이미지: Splunk 공식 블로그의 참조 아키텍처)*

**1. 인덱서 클러스터링 (Indexer Clustering)**

*   **목적:** 데이터의 유실 방지(Data Fidelity) 및 검색 성능 향상
*   **구성:** 여러 대의 인덱서를 하나의 클러스터로 묶고, **마스터 노드(Master Node)**가 이들을 관리합니다.
*   **동작 방식:**
    *   **데이터 복제 (Replication):** Forwarder가 보낸 데이터는 클러스터 내의 여러 인덱서에 복제되어 저장됩니다. (예: 복제 계수(Replication Factor)가 3이면, 원본 포함 총 3개의 인덱서에 데이터가 저장됨)
    *   **장애 극복 (Failover):** 특정 인덱서에 장애가 발생하더라도, 복제된 데이터가 다른 인덱서에 존재하므로 데이터 유실 없이 서비스를 계속할 수 있습니다.
    *   **검색 부하 분산:** 서치 헤드가 검색을 요청하면, 마스터 노드는 클러스터 내의 모든 인덱서에게 검색을 분산시켜 빠르게 결과를 얻을 수 있습니다.

**2. 서치 헤드 클러스터링 (Search Head Clustering)**

*   **목적:** 검색 서비스의 고가용성 및 사용자 환경의 일관성 유지
*   **구성:** 여러 대의 서치 헤드를 하나의 클러스터로 묶고, **디플로이어(Deployer)**라는 별도의 서버가 클러스터의 앱(대시보드, 리포트 등)과 설정 정보를 동기화합니다.
*   **동작 방식:**
    *   **상태 공유 (State Sharing):** 클러스터 내의 모든 서치 헤드는 동일한 설정과 앱(대시보드, 리포트 등)을 공유합니다. 사용자는 어떤 서치 헤드에 접속하더라도 항상 동일한 환경에서 작업할 수 있습니다.
    *   **장애 극복 (Failover):** 특정 서치 헤드에 장애가 발생하더라도, 사용자는 다른 서치 헤드에 접속하여 중단 없이 작업을 계속할 수 있습니다. (앞단에 로드 밸런서(Load Balancer)를 두어 자동으로 연결을 분산시킵니다.)

**3. 그 외의 컴포넌트**

*   **모니터링 콘솔 (Monitoring Console):** Splunk 전체 시스템의 건강 상태(CPU, 메모리, 디스크 사용량, 라이선스 등)를 모니터링하는 전용 인스턴스입니다.
*   **라이선스 마스터 (License Master):** Splunk의 라이선스를 중앙에서 관리하고, 각 인덱서의 데이터 사용량을 할당하는 역할을 합니다.
*   **디플로이먼트 서버 (Deployment Server):** 수천 대에 달하는 Universal Forwarder의 설정(어떤 로그를 수집할지 등)을 중앙에서 관리하고 배포하는 역할을 합니다.

## 다음 이야기

이번 파트에서는 대규모 환경에 적합한 Splunk 아키텍처의 핵심 요소들을 살펴보았습니다. 인덱서와 서치 헤드를 클러스터링하여 고가용성과 확장성을 확보하는 것이 Best Practice의 핵심입니다.

다음 파트에서는 드디어 실제 Hands-on을 시작합니다. **"[Hands-on] Splunk Enterprise 설치 및 기본 데이터 수집"**을 주제로, 직접 Splunk 서버를 설치하고 첫 번째 데이터를 수집하는 과정을 단계별로 따라가 보겠습니다.

---
