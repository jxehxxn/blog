---
layout: post
title:  "Splunk 고급편 Part 5: 사용자 행위 분석 (UBA) 개념 및 Splunk UBA 연동"
date:   2025-07-08 18:00:00 +0900
categories: jekyll update
---

## 시작하며: 개별 이벤트 너머의 위협을 탐지하다

지금까지 우리는 Splunk MLTK를 활용하여 시계열 데이터의 이상 징후를 탐지하고, 클러스터링을 통해 비정상적인 패턴을 분류하며, 예측 및 분류 모델을 구축하는 방법을 배웠습니다. 이러한 기법들은 특정 이벤트나 데이터 포인트의 이상을 탐지하는 데 매우 효과적입니다.

하지만 현대의 사이버 위협은 단일 이벤트만으로는 파악하기 어려운 복합적인 양상을 띠는 경우가 많습니다. 특히 내부자 위협, 계정 탈취, 권한 오용과 같은 공격은 정상적인 행위의 연속처럼 보일 수 있어 기존의 룰 기반 탐지나 개별 이벤트 분석만으로는 한계가 있습니다.

이러한 문제를 해결하고, 공격의 전체적인 맥락을 파악하여 숨겨진 위협을 찾아내는 데 필수적인 개념이 바로 **사용자 행위 분석(User Behavior Analytics, UBA)**입니다. 이번 파트에서는 UBA의 핵심 원리를 이해하고, Splunk의 UBA 솔루션이 어떻게 이러한 위협을 탐지하는지 알아보겠습니다.

## UBA란 무엇인가? '평소와 다른' 행위를 찾아라

UBA는 사용자(User) 또는 엔티티(Entity, 예: 서버, 애플리케이션)의 과거 행위 데이터를 분석하여 **정상적인 기준선(Baseline)**을 학습하고, 이 기준선에서 벗어나는 **비정상적인 행위(Anomalous Behavior)**를 탐지하는 보안 분석 기술입니다.

**UBA의 핵심 원리:**

1.  **프로파일링 (Profiling):** 각 사용자나 엔티티의 고유한 행위 패턴(로그인 시간, 접속 위치, 접근하는 시스템/데이터, 실행하는 명령어 등)을 지속적으로 학습하여 프로파일을 생성합니다.
2.  **기준선 학습 (Baseline Learning):** 프로파일링된 데이터를 기반으로 '평소에는 이렇게 행동한다'는 정상적인 행위의 기준선을 자동으로 학습합니다. 이는 고정된 룰이 아닌, 동적으로 변화하는 기준선입니다.
3.  **이상 징후 탐지 (Anomaly Detection):** 새로운 행위가 발생했을 때, 학습된 기준선과 비교하여 얼마나 벗어나는지 평가합니다. 벗어나는 정도가 크면 이상 징후로 플래그(Flag)를 지정합니다.
4.  **위험 점수 부여 (Risk Scoring):** 탐지된 이상 징후의 심각도와 빈도에 따라 사용자 또는 엔티티에 위험 점수(Risk Score)를 부여합니다. 단일 이벤트의 위험 점수는 낮더라도, 여러 이상 징후가 복합적으로 발생하여 위험 점수가 일정 수준을 넘어서면 경보를 발생시킵니다.

**UBA가 탐지할 수 있는 위협 시나리오:**

*   **비정상적인 로그인:** 평소 로그인하지 않던 시간대, 위치, 기기에서의 로그인 시도
*   **계정 탈취:** 특정 계정이 평소와 다른 시스템에 접근하거나, 비정상적인 명령어를 실행
*   **내부자 위협:** 퇴사를 앞둔 직원이 대량의 민감 데이터를 다운로드하거나, 평소 접근하지 않던 서버에 접속
*   **권한 오용:** 관리자 계정이 불필요한 시스템에 접근하거나, 비정상적인 권한 상승 시도
*   **데이터 유출:** 특정 사용자가 평소와 다른 방식으로 대량의 데이터를 외부로 전송

## Splunk UBA 솔루션 소개

Splunk는 독립적인 UBA 솔루션인 **Splunk User Behavior Analytics (Splunk UBA)**를 제공합니다. Splunk UBA는 Splunk Enterprise 또는 Splunk Cloud와 연동되어, 수집된 데이터를 기반으로 사용자 및 엔티티의 행위를 분석하고, 머신러닝 알고리즘을 통해 위협을 탐지합니다.

**Splunk UBA의 주요 특징:**

*   **다양한 데이터 소스 통합:** Splunk Enterprise에서 수집된 모든 종류의 로그(인증, 네트워크, 엔드포인트, 애플리케이션 등)를 UBA 분석에 활용합니다.
*   **고급 머신러닝 알고리즘:** 수십 가지의 내장된 머신러닝 모델을 사용하여 사용자 행위의 기준선을 학습하고, 다양한 유형의 이상 징후를 자동으로 탐지합니다.
*   **위험 점수 기반의 우선순위:** 탐지된 이상 징후에 위험 점수를 부여하고, 이 점수를 합산하여 전체적인 사용자/엔티티의 위험도를 평가합니다. 이를 통해 분석가는 수많은 경보 속에서 가장 시급하게 조사해야 할 위협에 집중할 수 있습니다.
*   **시각화된 위협 스토리:** 탐지된 위협을 타임라인 형태로 시각화하여, 공격의 전체적인 흐름과 관련된 모든 이벤트를 한눈에 파악할 수 있도록 돕습니다.
*   **Splunk Enterprise Security (ES) 연동:** Splunk UBA에서 탐지된 고위험 위협은 Splunk ES의 인시던트 리뷰(Incident Review) 대시보드로 자동 전송되어, 보안 분석가가 통합된 환경에서 조사하고 대응할 수 있도록 합니다.

## Splunk Enterprise와 Splunk UBA 간의 데이터 연동

Splunk UBA는 Splunk Enterprise에 저장된 데이터를 활용하여 분석을 수행합니다. 일반적인 연동 과정은 다음과 같습니다.

1.  **데이터 수집:** Splunk Enterprise가 Universal Forwarder, HTTP Event Collector(HEC) 등을 통해 다양한 소스에서 로그 데이터를 수집합니다.
2.  **CIM 정규화:** 수집된 데이터는 Splunk Enterprise 내에서 CIM(Common Information Model)에 따라 정규화됩니다. (중급편 Part 2 참조)
3.  **데이터 전송:** Splunk Enterprise는 정규화된 데이터를 Splunk UBA로 전송합니다. 이는 주로 Splunk UBA의 데이터 인제스터(Data Ingester)를 통해 이루어집니다.
4.  **UBA 분석:** Splunk UBA는 전송받은 데이터를 기반으로 사용자 및 엔티티의 프로파일을 구축하고, 머신러닝 알고리즘을 적용하여 이상 징후를 탐지하고 위험 점수를 계산합니다.
5.  **위협 알림:** Splunk UBA에서 탐지된 고위험 위협은 Splunk Enterprise Security(ES)로 다시 전송되거나, 별도의 알림 채널을 통해 보안 분석가에게 통보됩니다.

## 다음 이야기

이번 파트에서는 사용자 행위 분석(UBA)의 개념과 Splunk UBA 솔루션의 역할에 대해 알아보았습니다. UBA는 개별 이벤트의 이상을 넘어, 사용자 행위의 맥락을 분석하여 내부자 위협이나 계정 탈취와 같은 복합적인 위협을 탐지하는 데 필수적인 기술입니다.

이제 우리는 Splunk의 머신러닝과 UBA 기능을 통해 데이터에서 숨겨진 패턴을 발견하고, 이상 징후를 탐지하며, 미래를 예측하고, 사용자 행위의 비정상성을 파악하는 방법을 익혔습니다. 마지막 파트에서는 이 모든 고급 탐지 기법들을 실제 보안 운영 환경에서 어떻게 최적화하고 활용할 수 있는지에 대한 Best Practice를 다루며 시리즈를 마무리하겠습니다.

---
